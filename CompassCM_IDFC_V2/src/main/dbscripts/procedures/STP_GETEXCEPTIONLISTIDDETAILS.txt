CREATE OR REPLACE PROCEDURE STP_GETEXCEPTIONLISTIDDETAILS (
 i_vcListCode IN VARCHAR2,
 i_vcListId IN VARCHAR2,
 i_vcViewType  IN VARCHAR2,
 io_cuRESULTSET IN OUT SYS_REFCURSOR
 )
-- EXEC STP_GETEXCEPTIONLISTIDDETAILS('INTERNALWATCHLIST','Chamath-3611','INTERNALWATCHLIST',:KG);
AS
  vcQuery varchar2(5000);
BEGIN

  IF UPPER(i_vcListCode) LIKE 'NCIFLIST%' THEN
         vcQuery := 'SELECT NCIF_ID, FULL_NAME, DEDUP_KEY, TO_CHAR(DATE_OF_BIRTH,''DD-MON-YYYY'') DATE_OF_BIRTH, '||
                    '       GENDER, PANNO, DRIVINGLICENSENO, PASSPORTNO, VOTERIDENTITYNO, '||
                    '       REGISTRATIONNUMBER, REGISTRATIONDATE, MOBILENO, FAXNO, OCCUPATION, '||
                    '       IT_STATUS, ADDRESSLINE1, ADDRESSLINE2, ADDRESSLINE3, CITYCODE, '||
                    '       CITY, PINCODE, LASTUPDATEDDATE, ORIGINALSOURCE '||
                    '  FROM COMAML.TB_NCIFLIST '||
                    '  WHERE NCIF_ID ='''||i_vcListId||'''';
  END IF;
  IF UPPER(i_vcListCode) LIKE 'NCIFALIASLIST%' THEN
         vcQuery := 'SELECT NCIF_ID, RECORD_ID, FULL_NAME, FIRST_NAME, A.MIDDLE_NAME, A.LAST_NAME, '||
	           		'       TO_CHAR(DATEOFBIRTH,''DD-MON-YYYY'') DATEOFBIRTH, '||
                    '       DESIGNATION, ADDRESSLINE1, ADDRESSLINE2, ADDRESSLINE3, CITYCODE, '||
                    '       CITY, PINCODE, PHONENO, REMARKS, LASTUPDATEDDATE, ORIGINALSOURCE '||
                    '  FROM COMAML.TB_NCIFLIST_ALIASES A '||
                    '  WHERE NCIF_ID ='''||i_vcListId||'''';
  END IF;
  IF UPPER(i_vcListCode) LIKE 'OFACSDN%' THEN
         vcQuery := 'SELECT UID_,NAME,TITLE,SDNTYPE,REMARKS,ID_UID,IDTYPE,IDNUMBER,IDCOUNTRY,ISSUEDATE, '||
		            '       EXPIRATIONDATE,ADD_UID,ADDRESS1,ADDRESS2,ADDRESS3,CITY,STATEORPROVINCE,POSTALCODE,COUNTRY, '||
		            '       CALLSIGN,VESSELTYPE,VESSELFLAG,VESSELOWNER,TONNAGE,GROSSREGISTEREDTONNAGE '||
                    '  FROM COMAML.TB_OFACSDNLIST '||
                    ' WHERE UID_='''||i_vcListId||'''';
         vcQuery := 'SELECT UID_, LISTEDNAME, FIRSTNAME, LASTNAME, TITLE, SDNTYPE, REMARKS, PROGRAMS, '||
			        '       ID_UID, ID_IDTYPE, IDLIST_IDNUMBER, IDLIST_IDCOUNTRY, IDLIST_ISSUEDATE, '||
				    ' 	    IDLIST_EXPIRATIONDATE, AKALIST_UID, AKALIST_TYPE, AKALIST_CATEGORY, AKALIST_LISTEDNAME, '||
				    ' 	    AKALIST_FIRSTNAME, AKALIST_LASTNAME, ADDRESSLIST_UID, ADDRESSLIST_ADDRESS1, '||
				    ' 	    ADDRESSLIST_ADDRESS2, ADDRESSLIST_ADDRESS3, ADDRESSLIST_CITY, ADDRESSLIST_STATEORPROVINCE, '||
				    ' 	    ADDRESSLIST_POSTALCODE, ADDRESSLIST_COUNTRY, NATIONALITYLIST_UID, NATIONALITYLIST_COUNTRY, '||
				    '	    NATIONALITYLIST_MAINENTRY, CITIZENSHIPLIST_UID, CITIZENSHIPLIST_COUNTRY, CITIZENSHIPLIST_MAINENTRY, '||
				    ' 	    DATEOFBIRTHLIST_UID, DATEOFBIRTHLIST_DATEOFBIRTH, DATEOFBIRTHLIST_MAINENTRY, PLACEOFBIRTHLIST_UID, '||
				    ' 	    PLACEOFBIRTHLIST_PLACEOFBIRTH, PLACEOFBIRTHLIST_MAINENTRY, CALLSIGN, VESSELTYPE, VESSELFLAG, '||
				    '	    VESSELOWNER, TONNAGE, GROSSREGISTEREDTONNAGE, TO_CHAR(UPDATEDON,''DD-MON-YYYY'') UPDATEDON, UPDATEDBY '||
                    '  FROM COMAML.TB_NEWOFACSDNLIST '||
                    ' WHERE UID_='''||i_vcListId||''' ';
  END IF;

  IF UPPER(i_vcListCode) = 'NONCUSTOMER' THEN
	     vcQuery := 'SELECT NAME1, NAME2, NAME3, NAME4, NAME5, DATEOFBIRTH, PASSPORTNO, PANNO, ACCOUNTNO, CUSTOMERID, USERCODE, SERIALNO, '||
			   		'       TO_CHAR(UPDATETIMESTAMP,''DD-MON-YYYY'') UPLOADEDDATE '|| 
			   		'  FROM COMAML.TB_ONLINESCANNINGDATA WHERE SERIALNO = '''||i_vcListId||'''';

  END IF;

  IF UPPER(i_vcListCode) LIKE 'INTERNALWATCHLIST%' THEN
	     vcQuery := 'SELECT UNIQUEID, REFERENCENO, DATERECEIVED, LISTEDID, LISTEDNAME, LISTEDIDVALUE, LISTCODE, '||
			        '		TO_CHAR(UPDATETIMESTAMP,''DD-MON-YYYY'') UPDATETIMESTAMP, UPDATEDBY '||
			        '  FROM COMAML.TB_INTERNALWATCHLIST '||
			        ' WHERE UPPER(TRIM(UNIQUEID)) = UPPER(TRIM('''||i_vcListId||''')) ';
  END IF;
  
  IF UPPER(i_vcListCode) LIKE 'ACCUITY%' THEN
    	 vcQuery := 'SELECT * FROM COMAML.TB_ACCUITYLIST A WHERE UNIQUEID = UPPER(TRIM('''||i_vcListId||''')) ';
  END IF;
  
  IF UPPER(i_vcListCode) LIKE 'WORLDCHECKLIST%' THEN
    	 vcQuery := 'SELECT * FROM COMAML.TB_WORLDCHECKLIST A WHERE A.LISTEDID = UPPER(TRIM('''||i_vcListId||''')) ';

	     vcQuery := ' SELECT A.LISTEDID, A.CATEGORY, A.SUBCATEGORY, A.EDITOR, A.ENTEREDDATE, A.UPDATEDDATE, '||
	                '        A.TITLE, A.POSITION, A.FIRSTNAME, A.LASTNAME, A.LISTEDNAME, '||
	                '        A.ALTERNATIVESPELLING, A.ALIASES, A.AGE, A.AGEASOFDATE, A.DOB, A.DECEASED, '||
	                '        A.EI, A.SSN, A.FURTHERINFORMATION, A.PASSPORTSNO, A.PASSPORTSCOUNTRY, '||
	                '        A.IDNUMBERSTYPE, A.IDNUMBERSLOCATION, A.IDNUMBERS, A.PLACEOFBIRTH, '||
	                '        A.LOCATION_CITY, A.LOCATION_STATE, A.LOCATION_COUNTRY, A.LOCATION_CONTENT, '||
	                '        A.COUNTRIES, A.CITIZENSHIPS, FUN_GETLINKEDLISTEDNAME(A.COMPANIES) COMPANIES, '||
	                '        FUN_GETLINKEDLISTEDNAME(A.LINKEDTO) LINKEDTO, A.KEYWORDS, A.EXTERNALSOURCES, '||
	                '        UPDATETIMESTAMP, UPDATEDBY '||
	                '   FROM COMAML.TB_WORLDCHECKLIST A '||
					'  WHERE A.LISTEDID = UPPER(TRIM('''||i_vcListId||''')) ';
  END IF;
  
  IF UPPER(i_vcListCode) LIKE 'LOCALFIUEXCEPTIONLIST%' THEN
     	 vcQuery := 'SELECT * FROM COMAML.TB_LOCALFIUEXCEPTIONLIST A WHERE UNIQUEID = UPPER(TRIM('''||i_vcListId||''')) ';
  END IF;
  
  IF UPPER(i_vcListCode) LIKE 'LOCALEXCEPTIONLIST%' THEN
    	 vcQuery := 'SELECT * FROM COMAML.TB_LOCALEXCEPTIONLIST A WHERE UNIQUEID = UPPER(TRIM('''||i_vcListId||''')) ';
  END IF;
  
  IF UPPER(i_vcListCode) LIKE 'FIUCALLFORINFORMATIONLIST%' THEN
     	 vcQuery := 'SELECT * FROM COMAML.TB_FIUCALLFORINFORMATIONLIST A WHERE UNIQUEID = UPPER(TRIM('''||i_vcListId||''')) ';
  END IF;
  
  IF UPPER(i_vcListCode) LIKE 'FIUSUSPENSIONOFTXNSLIST%' THEN
     	 vcQuery := 'SELECT * FROM COMAML.TB_FIUSUSPENSIONOFTXNSLIST A WHERE UNIQUEID = UPPER(TRIM('''||i_vcListId||''')) ';
  END IF;

  IF UPPER(i_vcListCode) LIKE 'EXPORTERSLIST%' THEN
      	 vcQuery := 'SELECT * FROM COMAML.TB_EXPORTERSBLACKLIST A WHERE SERIAL_NOS = UPPER(TRIM('''||i_vcListId||''')) ';
  END IF;
  
  IF UPPER(i_vcListCode) LIKE 'IBABLACKLIST%' THEN
     	 vcQuery := 'SELECT * FROM COMAML.TB_IBABLACKLIST A WHERE SERIAL_NOS = UPPER(TRIM('''||i_vcListId||''')) ';
  END IF;
  
  IF UPPER(i_vcListCode) LIKE 'RBIWILFULDEFAULTERLIST%' THEN
     	 vcQuery := 'SELECT * FROM COMAML.TB_RBIWILFULDEFAULTERLIST A WHERE SERIAL_NOS = UPPER(TRIM('''||i_vcListId||''')) ';
  END IF;
  
  IF UPPER(i_vcListCode) LIKE 'UNCONSOLIDATED%' THEN
         vcQuery := 'SELECT DATAID SERIALNO, REPLACE(FIRST_NAME,CHR(39),'''')||'' ''||REPLACE(SECOND_NAME,CHR(39),'''') NAME, '||
	                '   	TITLE_VALUE TITLE,  REPLACE(IND_ALIAS_ALIAS_NAME,CHR(39),'''') ALIAS,  UN_LIST_TYPE REGION_TYPE, REPLACE(IND_ADDRESS_STATE_PROVINCE,CHR(39),'''') ADDRESS, '||
			   		'		REPLACE(DESIGNATION_VALUE,CHR(39),'''') DESIGNATIONS, '||
                    '       REPLACE(IND_DATE_OF_BIRTH_DATE,CHR(39),'''') DATEOFBIRTH, REPLACE(IND_POB_CITY,CHR(39),'''') PLACEOFBIRTH, '||
                    '       REPLACE(IND_DOCUMENT_NUMBER,CHR(39),'''') PASSPORTNOS, REPLACE(NATIONALITY_VALUE,CHR(39),'''') CITIZEN,  REPLACE(LISTED_ON,CHR(39),'''') LISTEDON, REPLACE(REMOVEDON,CHR(39),'''') REMOVEDON, '||
			        '		REPLACE(COMMENTS1,CHR(39),'''') REMARKS, '||
			    	'		REPLACE(THIRD_NAME,CHR(39),'''') AKA, REPLACE(FOURTH_NAME,CHR(39),'''') FKA '||
                    '  FROM COMAML.TB_UNC WHERE DATAID='''||i_vcListId||'''';

         vcQuery := 'SELECT DATAID, VERSIONNUM, FIRST_NAME, SECOND_NAME, THIRD_NAME, FOURTH_NAME, SORT_KEY, IND_ALIAS_ALIAS_NAME, '||
					'       UN_LIST_TYPE, REFERENCE_NUMBER, LISTED_ON, NATIONALITY_VALUE, LIST_TYPE_VALUE, '||
					'       IND_ALIAS_QUALITY, SUBMITTED_BY, IND_ADDRESS_CITY, IND_ADDRESS_STATE_PROVINCE, IND_ADDRESS_COUNTRY, '||
				    '       IND_DATE_OF_BIRTH_TYPE_OF_DATE, IND_DATE_OF_BIRTH_DATE, IND_POB_COUNTRY, IND_DOCUMENT_TYPE_OF_DOCUMENT, IND_DOCUMENT_NUMBER, '||
					'       COMMENTS1, LAST_DAY_UPDATED_VALUE, IND_ADDRESS_NOTE, IND_POB_CITY, '||
				    '       IND_DATE_OF_BIRTH_YEAR, IND_POB_STATE_PROVINCE, REMOVEDON, NATIONALITY2, IND_ALIAS_DATE_OF_BIRTH, '||
					'       IND_ALIAS_CITY_OF_BIRTH, IND_ALIAS_COUNTRY_OF_BIRTH, IND_ALIAS_NOTE, IND_DOCUMENT_ISSUING_COUNTRY, IND_DOCUMENT_DATE_OF_ISSUE, '||
				    '       IND_DOCUMENT_CITY_OF_ISSUE, IND_DOCUMENT_COUNTRY_OF_ISSUE, IND_DOCUMENT_TYPE_OF_DOCUMENT2, IND_DOCUMENT_NOTE, IND_ADDRESS_STREET, '||
					'       DESIGNATION_VALUE, ENT_ADDRESS_ZIP_CODE, TITLE_VALUE, IND_DATE_OF_BIRTH_FROM_YEAR, IND_DATE_OF_BIRTH_TO_YEAR, IND_POB_NOTE, '||
					'       GENDER, IND_DATE_OF_BIRTH_NOTE, SUBMITTED_ON, ENT_ADDRESS_NOTE, ENT_ALIAS_QUALITY, ENT_ALIAS_ALIAS_NAME, ENT_ADDRESS_CITY, '||
					'       ENT_ADDRESS_COUNTRY, ENT_ADDRESS_STREET, ENT_ADDRESS_STATE_PROVINCE, SORT_KEY_LAST_MOD, IND_ADDRESS_ZIP_CODE, '||
				    '       IND_ALIAS, LIST_TYPE, IND_ADDRESS, IND_POB, IND_DATE_OF_BIRTH, ENTITYTYPE, '||
					'       TO_CHAR(UPDATETIMESTAMP,''DD-MON-YYYY'') UPDATEDON, UPDATEDBY '||
				    '  FROM COMAML.TB_UNSANCTIONLIST '||
					' WHERE DATAID = '''||i_vcListId||''' ';
  END IF;

  IF UPPER(i_vcListCode) LIKE 'UNALQAIDA%' THEN
		 vcQuery := 'SELECT DATAID, VERSIONNUM, FIRST_NAME, SECOND_NAME, THIRD_NAME, FOURTH_NAME, SORT_KEY, IND_ALIAS_ALIAS_NAME, '||
					'       UN_LIST_TYPE, REFERENCE_NUMBER, LISTED_ON, NATIONALITY_VALUE, LIST_TYPE_VALUE, '||
					'       IND_ALIAS_QUALITY, SUBMITTED_BY, IND_ADDRESS_CITY, IND_ADDRESS_STATE_PROVINCE, IND_ADDRESS_COUNTRY, '||
					'       IND_DATE_OF_BIRTH_TYPE_OF_DATE, IND_DATE_OF_BIRTH_DATE, IND_POB_COUNTRY, IND_DOCUMENT_TYPE_OF_DOCUMENT, IND_DOCUMENT_NUMBER, '||
				    '       COMMENTS1, LAST_DAY_UPDATED_VALUE, IND_ADDRESS_NOTE, IND_POB_CITY, '||
					'       IND_DATE_OF_BIRTH_YEAR, IND_POB_STATE_PROVINCE, REMOVEDON, NATIONALITY2, IND_ALIAS_DATE_OF_BIRTH, '||
				    '       IND_ALIAS_CITY_OF_BIRTH, IND_ALIAS_COUNTRY_OF_BIRTH, IND_ALIAS_NOTE, IND_DOCUMENT_ISSUING_COUNTRY, IND_DOCUMENT_DATE_OF_ISSUE, '||
				    '       IND_DOCUMENT_CITY_OF_ISSUE, IND_DOCUMENT_COUNTRY_OF_ISSUE, IND_DOCUMENT_TYPE_OF_DOCUMENT2, IND_DOCUMENT_NOTE, IND_ADDRESS_STREET, '||
				    '       DESIGNATION_VALUE, ENT_ADDRESS_ZIP_CODE, TITLE_VALUE, IND_DATE_OF_BIRTH_FROM_YEAR, IND_DATE_OF_BIRTH_TO_YEAR, IND_POB_NOTE, '||
				 	'       GENDER, IND_DATE_OF_BIRTH_NOTE, SUBMITTED_ON, ENT_ADDRESS_NOTE, ENT_ALIAS_QUALITY, ENT_ALIAS_ALIAS_NAME, ENT_ADDRESS_CITY, '||
				    '       ENT_ADDRESS_COUNTRY, ENT_ADDRESS_STREET, ENT_ADDRESS_STATE_PROVINCE, SORT_KEY_LAST_MOD, IND_ADDRESS_ZIP_CODE, '||
				    '       IND_ALIAS, LIST_TYPE, IND_ADDRESS, IND_POB, IND_DATE_OF_BIRTH, ENTITYTYPE, '||
				    '       TO_CHAR(UPDATETIMESTAMP,''DD-MON-YYYY'') UPDATEDON, UPDATEDBY '||
				    '  FROM COMAML.TB_UNALQAIDALIST '||
					' WHERE DATAID = '''||i_vcListId||''' ';
   END IF;

   IF UPPER(i_vcListCode) LIKE 'UNTALIBAN%' THEN
 		vcQuery :=  'SELECT DATAID, VERSIONNUM, FIRST_NAME, SECOND_NAME, THIRD_NAME, FOURTH_NAME, SORT_KEY, IND_ALIAS_ALIAS_NAME, '||
					'       UN_LIST_TYPE, REFERENCE_NUMBER, LISTED_ON, NATIONALITY_VALUE, LIST_TYPE_VALUE, '||
				    '       IND_ALIAS_QUALITY, SUBMITTED_BY, IND_ADDRESS_CITY, IND_ADDRESS_STATE_PROVINCE, IND_ADDRESS_COUNTRY, '||
				    '       IND_DATE_OF_BIRTH_TYPE_OF_DATE, IND_DATE_OF_BIRTH_DATE, IND_POB_COUNTRY, IND_DOCUMENT_TYPE_OF_DOCUMENT, IND_DOCUMENT_NUMBER, '||
					'       COMMENTS1, LAST_DAY_UPDATED_VALUE, IND_ADDRESS_NOTE, IND_POB_CITY, '||
				    '       IND_DATE_OF_BIRTH_YEAR, IND_POB_STATE_PROVINCE, REMOVEDON, NATIONALITY2, IND_ALIAS_DATE_OF_BIRTH, '||
				    '       IND_ALIAS_CITY_OF_BIRTH, IND_ALIAS_COUNTRY_OF_BIRTH, IND_ALIAS_NOTE, IND_DOCUMENT_ISSUING_COUNTRY, IND_DOCUMENT_DATE_OF_ISSUE, '||
				    '       IND_DOCUMENT_CITY_OF_ISSUE, IND_DOCUMENT_COUNTRY_OF_ISSUE, IND_DOCUMENT_TYPE_OF_DOCUMENT2, IND_DOCUMENT_NOTE, IND_ADDRESS_STREET, '||
				    '       DESIGNATION_VALUE, ENT_ADDRESS_ZIP_CODE, TITLE_VALUE, IND_DATE_OF_BIRTH_FROM_YEAR, IND_DATE_OF_BIRTH_TO_YEAR, IND_POB_NOTE, '||
				    '       GENDER, IND_DATE_OF_BIRTH_NOTE, SUBMITTED_ON, ENT_ADDRESS_NOTE, ENT_ALIAS_QUALITY, ENT_ALIAS_ALIAS_NAME, ENT_ADDRESS_CITY, '||
				    '       ENT_ADDRESS_COUNTRY, ENT_ADDRESS_STREET, ENT_ADDRESS_STATE_PROVINCE, SORT_KEY_LAST_MOD, IND_ADDRESS_ZIP_CODE, '||
				    '       IND_ALIAS, LIST_TYPE, IND_ADDRESS, IND_POB, IND_DATE_OF_BIRTH, ENTITYTYPE, '||
				    '       TO_CHAR(UPDATETIMESTAMP,''DD-MON-YYYY'') UPDATEDON, UPDATEDBY '||
					'  FROM COMAML.TB_UNTALIBANLIST '||
					' WHERE DATAID = '''||i_vcListId||''' ';
  END IF;

  IF UPPER(i_vcListCode) LIKE 'RBIDEFAULTERSLIST%' THEN
     	 vcQuery := 'SELECT ''DOCSRNO''||DOCSERIALNO AS DOCSERIALNO, NAMEOFBANK, PARTY, ADDRESS, '||
                    '		 NAMEOFDIRS, PARTNERS, PROPRIETER, BALOUTSTANDING, BRANCHNAME, STATE '||
		   			'  FROM COMAML.TB_RBIDEFAULTERSLIST A WHERE DOCSERIALNO = '''||i_vcListId||'''';
  END IF;
  IF UPPER(i_vcListCode) LIKE 'CUSTOMER%' THEN
 	  -- vcQuery := 'SELECT * FROM COMAML.TB_CUSTOMERMASTER A WHERE CUSTOMERID = '''||i_vcListId||'''';
		 vcQuery := 'SELECT A.CUSTOMERID, CUSTOMERNAME, CUSTOMERTYPE, '||
        			'  CASE WHEN CONSTITUTIONTYPE = ''I'' THEN ''INDIVIDUAL'' WHEN CONSTITUTIONTYPE=''C'' THEN ''CORPORATE'' END CONSTITUTIONTYPE, '||  
					'       CUSTOMERCATEGORY, MINOR, BANKCODE, BRANCHCODE, '|| 
					'       A.NATUREOFBUSINESS||'' - ''||(SELECT B.DESCRIPTION '||
					'  FROM COMAML.TB_REFERENCETYPEMASTER B '|| 
					' WHERE B.REFERENCETYPE = ''IND'' AND B.REFERENCECODE = A.NATUREOFBUSINESS AND ROWNUM = 1) NATUREOFBUSINESS, '|| 
					'       CREDITRATING, TO_CHAR(CREATEDDATETIME,''DD-MON-YYYY'') CREATEDDATETIME, INTRODUCERCUSTOMERID, '||
					'       INTRODUCERNAME, INTRODUCERCATEGORY, CUSTOMEREMPCODE, ESTIMATEDINCOMEFROMBUSINESS, OTHERINCOME, '||
					'       ANNUALINCOME, NET_WORTH, SALUTATION, FIRSTNAME, MIDDLENAME, LASTNAME, FATHERNAME, MOTHERNAME, '||
					'       TO_CHAR(A.DATEOFBIRTH,''DD-MON-YYYY'') DATEOFBIRTH, PLACEOFBIRTH, NATIONALITY, '||
					'       CASE WHEN RESIDENTIALSTATUS=''Y'' THEN ''DOMESTIC CUSTOMER'' '||
					'            WHEN RESIDENTIALSTATUS=''N'' THEN ''NRE/NRO CUSTOMER'' END RESIDENTIALSTATUS , AGE, '||  
					'       CASE WHEN SEX=''M'' THEN ''MALE'' WHEN SEX=''F'' THEN ''FEMALE'' END SEX , '||
					'       A.CBS_RISKRATING CBS_RISKRATING, A.CBS_RISKRATING RISKRATING, '||
					'       PANNO, DRIVINGLICENSENO, PASSPORTNO, VOTERIDENTITYCARDNO,  '||
					'       CASE WHEN MARITALSTATUS=''M'' THEN ''MARRIED'' WHEN MARITALSTATUS=''U'' THEN ''UNMARRIED'' END MARITALSTATUS , '||  
					'       DEPENDENTS, A.OCCUPATION||'' - ''||(SELECT B.DESCRIPTION '||
					'  FROM COMAML.TB_OCCUPATIONCODEDETAILS B '||
					' WHERE B.CODE = A.OCCUPATION AND ROWNUM = 1) OCCUPATION, ISSUINGAUTHORITY, '||
					'       NVL(TRIM(A.TIN),'' '') TIN, NVL(TRIM(A.SSNO),'' '') SSNO, '||
					'       PLACEOFISSUE, IDCARD, ADDRESSLINE1, ADDRESSLINE2, ADDRESSLINE3, CITY, STATE, COUNTRY, '||  
					'       PINCODE, PHONENO, MOBILENO, FAXNO, EMAILID, WEBSITE,  '||
					'       COMM_ADDRESSLINE1, COMM_ADDRESSLINE2, COMM_CITY, COMM_STATE, COMM_COUNTRY, COMM_PINCODE, '||  
					'       COMM_PHONENO, COMM_FAXNO, COMM_EMAILID,  '||
					        /*
					'       OFFICEADDRESSLINE1, OFFICEADDRESSLINE2, OFFICECITY, OFFICESTATE, OFFICECOUNTRY, '||   
					'       OFFICEADDRESS_PINCODE, OFFICEADDRESS_PHONENO, OFFICEADDRESS_FAXNO, '||
					'       REGISTEREDADDRESSLINE1, REGISTEREDADDRESSLINE2, REGISTEREDCITY, REGISTEREDSTATE, REGISTEREDCOUNTRY, '||   
					'       REGISTEREDADDRESS_PINCODE, REGISTEREDADDRESS_PHONENO, REGISTEREDADDRESS_FAXNO,  '||
					'       RESIDENCEADDRESSLINE1, RESIDENCEADDRESSLINE2, RESIDENCECITY, RESIDENCESTATE, RESIDENCECOUNTRY, '||   
					'       RESIDENCEADDRESS_PINCODE, RESIDENCEADDRESS_PHONENO, RESIDENCEADDRESS_FAXNO, '||
					'       ALTERNATEADDRESSLINE1, ALTERNATEADDRESSLINE2, ALTERNATECITY, ALTERNATESTATE, ALTERNATECOUNTRY, '||   
					'       ALTERNATEADDRESS_PINCODE, ALTERNATEADDRESS_PHONENO, ALTERNATEADDRESS_FAXNO, '||
					        */
					'       PRIMARY_SEGMENT, EDUCATION, GRADE, ISNPOCUSTOMER, ISPEPCUSTOMER, PAN_STATUS_LU_CODE, '|| 
					'       GUARDIANID, GUARDIANRELATION, GUARDIANNAME, GUARDIANADDRESSLINE1, GUARDIANADDRESSLINE2, '||
					'       GUARDIANCITY, GUARDIANSTATE, GUARDIANPINCODE, GUARDIANPHONENO, GUARDIANCOUNTRY, '||
					'       REG_NUMBER, TO_CHAR(REG_EFFECTIVE_DATE,''DD-MON-YYYY'') REG_EFFECTIVE_DATE, '||
					'       TO_CHAR(REG_EXPIRY_DATE,''DD-MON-YYYY'') REG_EXPIRY_DATE, REG_PLACE, INCOME_SLAB_LU, '|| 
					'       A.INCOME_SLAB_LU_CODE1||'' - ''||(SELECT B.DESCRIPTION '||
					' FROM  COMAML.TB_REFERENCETYPEMASTER B '||
					'WHERE  B.REFERENCETYPE = ''ISL'' AND B.REFERENCECODE = A.INCOME_SLAB_LU_CODE1 AND ROWNUM = 1) INCOME_SLAB_LU_CODE1, '|| 
					'       PAIDUP_CAPITAL, PROFIT_LOSS, TO_CHAR(FROM_FINANCIAL_DATE,''DD-MON-YYYY'') FROM_FINANCIAL_DATE, TO_CHAR(TO_FINANCIAL_DATE,''DD-MON-YYYY'') TO_FINANCIAL_DATE, AUTHORIZED_CAPITAL, NATURE_OF_BUSINESS_LU, '|| 
					'       A.NATURE_OF_BUSINESS_LU_CODE1||'' - ''||(SELECT B.DESCRIPTION '||
					' FROM  COMAML.TB_REFERENCETYPEMASTER B WHERE B.REFERENCETYPE = ''NBU'' '||
					'  AND  B.REFERENCECODE = A.NATURE_OF_BUSINESS_LU_CODE1 AND ROWNUM = 1) NATURE_OF_BUSINESS_LU_CODE1, '||
					'		NO_OF_DIRECTORS, CORPORATE_PARTY_ID, PHONE_DETAILS, '||
					'       RM_CODE, RM_NAME, RM_EMAIL, RM_MOBILE '||
					' FROM  COMAML.TB_CUSTOMERMASTER A '||
					' WHERE A.CUSTOMERID = '''||i_vcListId||'''';
  END IF;
		
  IF UPPER(i_vcListCode) LIKE 'EMPLOYEE%' THEN
     vcQuery := 'SELECT * FROM COMAML.TB_EMPLOYEEMASTER A WHERE EMPCODE = '''||i_vcListId||'''';
  END IF;

   OPEN io_cuRESULTSET FOR vcQuery;

END STP_GETEXCEPTIONLISTIDDETAILS;
/
