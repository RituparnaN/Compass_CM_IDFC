CREATE OR REPLACE PROCEDURE STP_GETBRANCHDETAILS (
i_vcBranchCode	 IN VARCHAR2,			i_vcUserCode     IN VARCHAR2, 
i_vcGroupCode    IN VARCHAR2,			i_vcIPAddress    IN VARCHAR2,	   
io_cuResultSet1  IN OUT SYS_REFCURSOR,	io_cuResultSet2  IN OUT SYS_REFCURSOR,
io_cuResultSet3  IN OUT SYS_REFCURSOR,	io_cuResultSet4  IN OUT SYS_REFCURSOR

---EXEC STP_GETBRANCHDETAILS('5023','','','',:RC1,:RC2,:RC3,:RC4);

)
AS
vcSql VARCHAR2(32000);

CURSOR cuBranchMaster IS
SELECT A.BRANCHCODE, A.BRANCHNAME, A.BANKCODE, A.BRANCHAREA, A.BSRCODE, A.BRANCHMANAGERNAME, A.BRANCHADDR1,
	   A.BRANCHADDR2, A.BRANCHADDR3, A.BRANCHADDR4, A.BRANCHADDR5, A.BRANCHPINCODE, A.BRANCHCOUNTRY, A.BRANCHEMAIL, 
	   A.BRANCHTELEPHONE, A.BRANCHFAX, A.BRANCHMOBILENO, A.BRANCHWEBSITE, A.UIDISSUDBYFIU, A.CATEGORYCODE, A.REGIONCODE,
	   A.CLEARINGAREA, A.CLHOUSECODE, A.ISINCLUDED, A.REMARKS, A.UPDATETIMESTAMP, A.UPDATEDBY, A.REGIONNAME, A.DIVISIONNAME,
	   A.CIRCLENAME, A.TDS_CIRCLENAME, A.UNIFORM_BRCODE
  FROM COMAML.TB_BRANCHMASTER A
 WHERE A.BRANCHCODE = i_vcBranchCode;
 
 cuCtrlRecordData cuBranchMaster%ROWTYPE;
 
 BEGIN
  OPEN cuBranchMaster;
  LOOP 
       FETCH cuBranchMaster INTO cuCtrlRecordData;
       EXIT WHEN cuBranchMaster%NOTFOUND;
   END LOOP;
   
   OPEN io_cuResultSet1 FOR
 SELECT 'Branch Information^~^Branch Address Details' TABNAMES
   FROM DUAL;
   
   OPEN io_cuResultSet2 FOR
 SELECT 'D^~^D' TABDISPLAY
   FROM DUAL;
   
   OPEN io_cuResultSet3 FOR
 SELECT cuCtrlRecordData.BRANCHCODE BRANCHCODE, cuCtrlRecordData.BRANCHNAME BRANCHNAME, cuCtrlRecordData.BANKCODE BANKCODE, 
 		cuCtrlRecordData.BRANCHAREA BRANCHAREA, cuCtrlRecordData.BSRCODE BSRCODE, cuCtrlRecordData.UIDISSUDBYFIU UIDISSUDBYFIU, 
 		cuCtrlRecordData.BRANCHMANAGERNAME BRANCHMANAGERNAME
   FROM DUAL; 
   
   OPEN io_cuResultSet4 FOR
 SELECT cuCtrlRecordData.BRANCHADDR1 BRANCHADDR1, cuCtrlRecordData.BRANCHADDR2 BRANCHADDR2, cuCtrlRecordData.BRANCHADDR3 BRANCHADDR3, 
 		cuCtrlRecordData.BRANCHADDR4 BRANCHADDR4, cuCtrlRecordData.BRANCHADDR5 BRANCHADDR5, cuCtrlRecordData.BRANCHCOUNTRY BRANCHCOUNTRY, 
 		cuCtrlRecordData.BRANCHFAX BRANCHFAX, cuCtrlRecordData.BRANCHTELEPHONE BRANCHTELEPHONE, cuCtrlRecordData.BRANCHPINCODE BRANCHPINCODE, 
 		cuCtrlRecordData.BRANCHEMAIL BRANCHEMAIL 
   FROM DUAL;
   
 END STP_GETBRANCHDETAILS;
/

   
   
   
   