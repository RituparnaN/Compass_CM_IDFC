CREATE OR REPLACE PROCEDURE STP_GETCUSTOMERDETAILS(
i_vcCustomerId	  IN VARCHAR2,          	  i_vcUserCode		IN VARCHAR2,
i_vcGroupCode	  IN VARCHAR2,           	 i_vcIPAddress		IN VARCHAR2,
io_cuResultSet1  IN OUT SYS_REFCURSOR,    io_cuResultSet2     IN OUT SYS_REFCURSOR,
io_cuResultSet3  IN OUT SYS_REFCURSOR,    io_cuResultSet4     IN OUT SYS_REFCURSOR,
io_cuResultSet5  IN OUT SYS_REFCURSOR,    io_cuResultSet6     IN OUT SYS_REFCURSOR,
io_cuResultSet7  IN OUT SYS_REFCURSOR,    io_cuResultSet8     IN OUT SYS_REFCURSOR,
io_cuResultSet9  IN OUT SYS_REFCURSOR,    io_cuResultSet10    IN OUT SYS_REFCURSOR,
io_cuResultSet11 IN OUT SYS_REFCURSOR,    io_cuResultSet12    IN OUT SYS_REFCURSOR,
io_cuResultSet13 IN OUT SYS_REFCURSOR,    io_cuResultSet14    IN OUT SYS_REFCURSOR,
io_cuResultSet15 IN OUT SYS_REFCURSOR
--EXEC STP_GETCUSTOMERDETAILS('59639074','','','', :RC1, :RC2, :RC3, :RC4, :RC5, :RC6, :RC7, :RC8, :RC9, :RC10, :RC11, :RC12, :RC13, :RC14, :RC15);
)
AS
vcSql VARCHAR2(32000);

CURSOR cuCustomerMaster IS
SELECT A.CUSTOMERID, A.CUSTOMERNAME, A.CUSTOMERTYPE, A.CONSTITUTIONTYPE, A.CUSTOMERCATEGORY, A.MINOR, A.BANKCODE, A.BRANCHCODE, A.CREATEDDATETIME, A.INTRODUCERCUSTOMERID,
	   A.INTRODUCERNAME, A.INTRODUCERCATEGORY, A.CUSTOMEREMPCODE, A.CREDITRATING, A.OCCUPATION, A.NATUREOFBUSINESS, A.ESTIMATEDINCOMEFROMBUSINESS, A.OTHERINCOME, 
	   A.ANNUALINCOME, A.NET_WORTH, A.INVESTMENTS_VAL, A.SOURCEOFFUNDS, A.SALUTATION, A.FIRSTNAME, A.MIDDLENAME, A.LASTNAME, A.FATHERNAME, A.MOTHERNAME, A.DATEOFBIRTH, 
	   A.PLACEOFBIRTH, A.IDENTIFICATIONMARKS, A.AGE, A.SEX, A.MARITALSTATUS, A.DEPENDENTS, A.NATIONALITY, A.RESIDENTIALSTATUS, A.PANNO, A.PASSPORTNO, A.ISSUINGAUTHORITY, 
	   A.PLACEOFISSUE, A.DRIVINGLICENSENO, A.VOTERIDENTITYCARDNO, A.IDCARD, A.SSNO, A.TIN, A.PAN_STATUS_LU_CODE, A.PARTY_TYPE_LU_CODE, A.PRIMARY_SEGMENT, A.EDUCATION, 
	   A.GRADE, A.BANKVISIT, A.LOANSAVAILED, A.ADDRESSLINE1, A.ADDRESSLINE2, A.ADDRESSLINE3, A.CITY, A.STATE, A.COUNTRY, A.PINCODE, A.PHONENO, A.MOBILENO, A.FAXNO, A.EMAILID, 
	   A.WEBSITE, A.COMM_ADDRESSLINE1, A.COMM_ADDRESSLINE2, A.COMM_CITY, A.COMM_STATE, A.COMM_COUNTRY, A.COMM_PINCODE, A.COMM_PHONENO, A.COMM_FAXNO, A.COMM_EMAILID, 
	   A.OFFICEADDRESSLINE1, A.OFFICEADDRESSLINE2, A.OFFICECITY, A.OFFICESTATE, A.OFFICECOUNTRY, A.REGISTEREDADDRESSLINE1, A.REGISTEREDADDRESSLINE2, A.REGISTEREDCITY, 
	   A.REGISTEREDSTATE, A.REGISTEREDCOUNTRY, A.RESIDENCEADDRESSLINE1, A.RESIDENCEADDRESSLINE2, A.RESIDENCECITY, A.RESIDENCESTATE, A.RESIDENCECOUNTRY, 
	   A.ALTERNATEADDRESSLINE1, A.ALTERNATEADDRESSLINE2, A.ALTERNATECITY, A.ALTERNATESTATE, A.ALTERNATECOUNTRY, A.EMPLOYERCODE, A.EMPLOYERADDRESSLINE1, A.EMPLOYERADDRESSLINE2, 
	   A.EMPLOYERCITY, A.EMPLOYERSTATE, A.EMPLOYERCOUNTRY, A.EMPLOYERPINCODE, A.EMPLOYERPHONENO, A.EMPLOYERFAXNO, A.EMPLOYEREMAILID, A.CUSTOMERTYPECODE, A.CUSTOMERSTATCODE, 
	   A.REMARKS, A.PARTYID, A.RISKRATING, A.CBS_RISKRATING, FUN_DATETOCHAR(RISK_EFFECTIVE_FROM) RISK_EFFECTIVE_FROM, FUN_DATETOCHAR(RISK_EFFECTIVE_TO) RISK_EFFECTIVE_TO, A.ISNPOCUSTOMER, A.ISPEPCUSTOMER, A.GUARDIANID, A.GUARDIANRELATION, 
	   A.GUARDIANNAME, A.GUARDIANADDRESSLINE1, A.GUARDIANADDRESSLINE2, A.GUARDIANCITY, A.GUARDIANSTATE, A.GUARDIANPINCODE, A.GUARDIANPHONENO, A.GUARDIANCOUNTRY, 
	   FUN_DATETOCHAR(LASTUPDATEDDATE) LASTUPDATEDDATE, A.ISGREENCARDHOLDER, A.ISSUBSTANTIALPRESENCEINUS, A.ISRESIDENCEADDRESSINUS, A.ISPOSTALADDRESSINUS, A.ISPLACEOFBIRTHINUS,
	   A.ISCOUNTRYOFBIRTHINUS, A.ISCAREOFADDRESSINUS, A.ISHOLDMAILADDRESSINUS, A.ISPOBOXNOINUS, A.ISPHONENUMBERINUS, A.ISSTANDINGINSTRUCTIONTOUSACCT, A.ISTOWNOFINCORPORATIONINUS, 
	   A.ISCOUNTRYOFINCORPORATIONINUS, A.ISREGISTRATIONADDRESSINUS, A.ISINVOLVEDINACTIVETRADE, A.ISUSPERSONSAS10SHAREHOLDING, A.ISNFFE, A.ISW8W9FORMATTACHED, A.ISRECALCITRANT, 
	   FUN_DATETOCHAR(UPDATETIMESTAMP) UPDATETIMESTAMP, A.UPDATEDBY, A.ADDITIONALINFO, A.OFFICEADDRESS_PINCODE, A.REGISTEREDADDRESS_PINCODE, A.RESIDENCEADDRESS_PINCODE,
	   A.ALTERNATEADDRESS_PINCODE, A.OWNER_NAME, A.INDUSTRY_ID_LU, A.INDUSTRY_ID_LU_CODE1, A.EST_YEAR, A.REG_NUMBER, FUN_DATETOCHAR(REG_EFFECTIVE_DATE) REG_EFFECTIVE_DATE, 
	   FUN_DATETOCHAR(REG_EXPIRY_DATE) REG_EXPIRY_DATE, A.REG_PLACE, A.NATURE_OF_BUSINESS_LU, A.NATURE_OF_BUSINESS_LU_CODE1, A.NO_OF_DIRECTORS, A.CORPORATE_PARTY_ID, A.APEX_HOLDER,
	   A.INCOME_SLAB_LU, A.INCOME_SLAB_LU_CODE1, A.PAIDUP_CAPITAL, A.PROFIT_LOSS, FUN_DATETOCHAR(FROM_FINANCIAL_DATE) FROM_FINANCIAL_DATE, 
	   FUN_DATETOCHAR(TO_FINANCIAL_DATE) TO_FINANCIAL_DATE, A.AUTHORIZED_CAPITAL, A.OFFICEADDRESS_PHONENO, A.OFFICEADDRESS_FAXNO, A.REGISTEREDADDRESS_PHONENO, A.REGISTEREDADDRESS_FAXNO,
	   A.RESIDENCEADDRESS_PHONENO, A.RESIDENCEADDRESS_FAXNO, A.ALTERNATEADDRESS_PHONENO, A.ALTERNATEADDRESS_FAXNO, A.PHONE_DETAILS, A.RM_CODE, A.RM_NAME, A.RM_EMAIL, A.RM_MOBILE, 
	   A.PARTY_IC, A.CLASSIFICATION_CAT_LU, A.CLASSIFICATION_CAT_LU_CODE1, A.FIELD1, A.FIELD2, A.FIELD3, A.FIELD4, A.FIELD5, A.FIELD6, A.FIELD7, A.FIELD8, A.FIELD9, A.FIELD10, A.IDVALUE
  FROM COMAML.TB_CUSTOMERMASTER A
 WHERE A.CUSTOMERID = i_vcCustomerId;

 cmCtrlRecordData cuCustomerMaster%ROWTYPE;
 
CURSOR cuCustEnrichmentMaster IS
SELECT FIELD1, FIELD2, FIELD3, FIELD4, FIELD5, FIELD6, FIELD7, FIELD8, FIELD9, FIELD10 
  FROM COMAML.TB_CUSTOMERENRICHMENTMASTER
 WHERE CUSTOMERID = i_vcCustomerId;

 cmCtrlEnrichRecordData cuCustEnrichmentMaster%ROWTYPE;
 
 

BEGIN
  OPEN cuCustomerMaster;
  LOOP 
      FETCH cuCustomerMaster INTO cmCtrlRecordData;
      EXIT WHEN cuCustomerMaster%NOTFOUND;
  END LOOP;
  
  OPEN cuCustEnrichmentMaster;
  LOOP 
      FETCH cuCustEnrichmentMaster INTO cmCtrlEnrichRecordData;
      EXIT WHEN cuCustEnrichmentMaster%NOTFOUND;
  END LOOP;

 
  OPEN io_cuResultSet1 FOR
SELECT 'Customer Information^~^Individual Details^~^Other Details^~^Minor Details^~^Communication Address^~^Other Address^~^Introducer Details^~^Related Account Details^~^Reported CTR/NTR Details^~^Reported STR Details^~^Reported CCR Details^~^Documents Receipt Details^~^Entity Enrichment' TABNAMES
  FROM DUAL;
  
  OPEN io_cuResultSet2 FOR
SELECT 'D^~^D^~^D^~^D^~^D^~^D^~^D^~^T^~^T^~^T^~^T^~^T^~^D' TABDISPLAY
  FROM DUAL;

  OPEN io_cuResultSet3 FOR
SELECT cmCtrlRecordData.CUSTOMERID CUSTOMERID, cmCtrlRecordData.CUSTOMERNAME CUSTOMERNAME, cmCtrlRecordData.CUSTOMERTYPE CUSTOMERTYPE,
       cmCtrlRecordData.CONSTITUTIONTYPE CONSTITUTIONTYPE, cmCtrlRecordData.BRANCHCODE BRANCHCODE, cmCtrlRecordData.PRIMARY_SEGMENT PRIMARY_SEGMENT, 
       cmCtrlRecordData.RISKRATING RISKRATING, cmCtrlRecordData.CBS_RISKRATING CBS_RISKRATING, cmCtrlRecordData.CREATEDDATETIME CREATEDDATETIME, 
       cmCtrlRecordData.MINOR MINOR, cmCtrlRecordData.OCCUPATION OCCUPATION, cmCtrlRecordData.NATUREOFBUSINESS NATUREOFBUSINESS, 
       cmCtrlRecordData.ANNUALINCOME ANNUALINCOME, cmCtrlRecordData.NATURE_OF_BUSINESS_LU_CODE1 NATURE_OF_BUSINESS_LU_CODE1, 
       cmCtrlRecordData.INCOME_SLAB_LU INCOME_SLAB_LU, cmCtrlRecordData.EDUCATION EDUCATION, cmCtrlRecordData.ISNPOCUSTOMER ISNPOCUSTOMER, 
       cmCtrlRecordData.ISPEPCUSTOMER ISPEPCUSTOMER, cmCtrlRecordData.EMPLOYERCODE EMPLOYERCODE, cmCtrlRecordData.NET_WORTH NET_WORTH
  FROM DUAL;
  
  OPEN io_cuResultSet4 FOR
SELECT cmCtrlRecordData.SALUTATION SALUTATION, cmCtrlRecordData.FIRSTNAME FIRSTNAME, cmCtrlRecordData.MIDDLENAME MIDDLENAME, 
       cmCtrlRecordData.LASTNAME LASTNAME, cmCtrlRecordData.DATEOFBIRTH DATEOFBIRTH, cmCtrlRecordData.PLACEOFBIRTH PLACEOFBIRTH, 
       cmCtrlRecordData.AGE AGE, cmCtrlRecordData.SEX GENDER, cmCtrlRecordData.MARITALSTATUS MARITALSTATUS, cmCtrlRecordData.NATIONALITY NATIONALITY, 
       cmCtrlRecordData.FATHERNAME FATHERNAME, cmCtrlRecordData.MOTHERNAME MOTHERNAME, cmCtrlRecordData.PANNO PANNO, cmCtrlRecordData.PASSPORTNO PASSPORTNO, 
       cmCtrlRecordData.PLACEOFISSUE PLACEOFISSUE, cmCtrlRecordData.DRIVINGLICENSENO DRIVINGLICENSENO, cmCtrlRecordData.VOTERIDENTITYCARDNO VOTERIDENTITYCARDNO, 
       cmCtrlRecordData.SSNO SSNO, cmCtrlRecordData.GRADE GRADE, cmCtrlRecordData.REG_NUMBER REGISTRATIONNUMBER, cmCtrlRecordData.TIN TIN, 
       cmCtrlRecordData.REG_PLACE REGISTRATIONPLACE, cmCtrlRecordData.REG_EFFECTIVE_DATE REGISTRATIONDATE, cmCtrlRecordData.REG_EXPIRY_DATE REGISTRATIONEXPIRYDATE
  FROM DUAL;
  
  OPEN io_cuResultSet5 FOR SELECT 1 FROM DUAL;
  OPEN io_cuResultSet6 FOR SELECT 1 FROM DUAL;
  OPEN io_cuResultSet7 FOR SELECT 1 FROM DUAL;
  OPEN io_cuResultSet8 FOR SELECT 1 FROM DUAL;
  OPEN io_cuResultSet9 FOR SELECT 1 FROM DUAL;
  OPEN io_cuResultSet10 FOR SELECT 1 FROM DUAL;
  OPEN io_cuResultSet11 FOR SELECT 1 FROM DUAL;
  OPEN io_cuResultSet12 FOR SELECT 1 FROM DUAL;
  OPEN io_cuResultSet13 FOR SELECT 1 FROM DUAL;
  OPEN io_cuResultSet14 FOR SELECT 1 FROM DUAL;
  
  OPEN io_cuResultSet15 FOR
SELECT cmCtrlEnrichRecordData.FIELD1 FIELD1, cmCtrlEnrichRecordData.FIELD2 FIELD2, cmCtrlEnrichRecordData.FIELD3 FIELD3, cmCtrlEnrichRecordData.FIELD4 FIELD4, 
	   cmCtrlEnrichRecordData.FIELD5 FIELD5, cmCtrlEnrichRecordData.FIELD6 FIELD6, cmCtrlEnrichRecordData.FIELD7 FIELD7, cmCtrlEnrichRecordData.FIELD8 FIELD8, 
	   cmCtrlEnrichRecordData.FIELD9 FIELD9, cmCtrlEnrichRecordData.FIELD10 FIELD10 
  FROM DUAL;
  
END  STP_GETCUSTOMERDETAILS;
/
