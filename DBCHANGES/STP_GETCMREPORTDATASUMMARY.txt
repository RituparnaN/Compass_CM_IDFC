SET DEFINE OFF;

create or replace PROCEDURE "STP_GETCMREPORTDATASUMMARY"
(
  i_vcAssessmentPeriod  IN VARCHAR2,        i_vcUserCode     IN VARCHAR2,
  i_vcUserRole      IN VARCHAR2,            ipAddress        IN VARCHAR2,
  io_cuResultSet0   IN OUT SYS_REFCURSOR,   io_cuResultSet1  IN OUT SYS_REFCURSOR,
  io_cuResultSet2   IN OUT SYS_REFCURSOR,   io_cuResultSet3  IN OUT SYS_REFCURSOR,
  io_cuResultSet4   IN OUT SYS_REFCURSOR,   io_cuResultSet5  IN OUT SYS_REFCURSOR,
  io_cuResultSet6   IN OUT SYS_REFCURSOR,   io_cuResultSet7  IN OUT SYS_REFCURSOR
)
AS

vcSQL   VARCHAR2(32000);
vcSQL0  VARCHAR2(32000);
vcSQL1  VARCHAR2(32000);
vcSQL2  VARCHAR2(32000);
vcSQL3  VARCHAR2(32000);
vcSQL4  VARCHAR2(32000);
vcSQL5  CLOB;
vcSQL6  VARCHAR2(32000);
vcSQL7  VARCHAR2(32000);

BEGIN

vcSQL0 := 'SELECT ''TREASURY^~^RETAIL LIABILITIES^~^RETAIL ASSETS^~^WHOLESALE BANKING^~^RISK ASSESSMENT SUMMARY'' AS TABSNAME FROM DUAL ';

vcSQL1 :=
         'SELECT ROW_NUMBER() OVER (ORDER BY
		CASE 
		WHEN T1.CATEGORY = ''customer'' THEN 1
		WHEN T1.CATEGORY = ''geography'' THEN 2
		WHEN T1.CATEGORY = ''products and services'' THEN 3
		WHEN T1.CATEGORY = ''transactions'' THEN 4
		WHEN T1.CATEGORY = ''delivery channels'' THEN 5
		WHEN T1.CATEGORY = ''Governance & Management Oversight'' THEN 6
		WHEN T1.CATEGORY = ''Customer Due Diligence & Risk Management'' THEN 7   
		WHEN T1.CATEGORY = ''Transactions Monitoring'' THEN 8
		WHEN T1.CATEGORY = ''Internal Quality Assurance and Compliance Testing'' THEN 9
		WHEN T1.CATEGORY = ''Name/Sanctions Screening'' THEN 10
		WHEN T1.CATEGORY = ''Training'' THEN 11
		WHEN T1.CATEGORY = ''Foreign Correspondent Banking Relationships'' THEN 12
		WHEN T1.CATEGORY = ''Internal Audit'' THEN 13
		WHEN T1.CATEGORY = ''Reporting Requirements'' THEN 14
		ELSE 15 END) AS SRNO,
		T1.CATEGORY, 
		(CASE WHEN T1.CATEGORY = ''customer'' THEN ''30%''
		WHEN T1.CATEGORY = ''geography'' THEN ''25%''
		WHEN T1.CATEGORY = ''products and services'' THEN ''25%''
		WHEN T1.CATEGORY = ''transactions'' THEN ''10%''
		WHEN T1.CATEGORY = ''delivery channels'' THEN ''10%''
		WHEN T1.CATEGORY = ''Governance & Management Oversight'' THEN ''10%''
		WHEN T1.CATEGORY = ''Customer Due Diligence & Risk Management'' THEN ''25%''   
		WHEN T1.CATEGORY = ''Transactions Monitoring'' THEN ''10%''
		WHEN T1.CATEGORY = ''Internal Quality Assurance and Compliance Testing'' THEN ''10%''
		WHEN T1.CATEGORY = ''Name/Sanctions Screening'' THEN ''10%''
		WHEN T1.CATEGORY = ''Training'' THEN ''15%''
		WHEN T1.CATEGORY = ''Foreign Correspondent Banking Relationships'' THEN ''5%''
		WHEN T1.CATEGORY = ''Internal Audit'' THEN ''10%''
		WHEN T1.CATEGORY = ''Reporting Requirements'' THEN ''5%''
		ELSE ''N.A.'' END) AS WEIGHT, 
		T1.SCORE, T1.SCORE AS RESULT  FROM
		(SELECT
		FINALRISKRATING AS SCORE, CATEGORY
		FROM COMAML_CM.TB_RARISKRATINGS A 
		LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO 
		WHERE A.CATEGORY = A.SUBCATEGORY
		AND A.ASSESSMENTUNIT = ''Treasury''
		AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T1';

vcSQL2 :=
         'SELECT ROW_NUMBER() OVER (ORDER BY
		CASE 
		WHEN T1.CATEGORY = ''customer'' THEN 1
		WHEN T1.CATEGORY = ''geography'' THEN 2
		WHEN T1.CATEGORY = ''products and services'' THEN 3
		WHEN T1.CATEGORY = ''transactions'' THEN 4
		WHEN T1.CATEGORY = ''delivery channels'' THEN 5
		WHEN T1.CATEGORY = ''Governance & Management Oversight'' THEN 6
		WHEN T1.CATEGORY = ''Customer Due Diligence & Risk Management'' THEN 7   
		WHEN T1.CATEGORY = ''Transactions Monitoring'' THEN 8
		WHEN T1.CATEGORY = ''Internal Quality Assurance and Compliance Testing'' THEN 9
		WHEN T1.CATEGORY = ''Name/Sanctions Screening'' THEN 10
		WHEN T1.CATEGORY = ''Training'' THEN 11
		WHEN T1.CATEGORY = ''Foreign Correspondent Banking Relationships'' THEN 12
		WHEN T1.CATEGORY = ''Internal Audit'' THEN 13
		WHEN T1.CATEGORY = ''Reporting Requirements'' THEN 14
		ELSE 15 END) AS SRNO,
		T1.CATEGORY, 
		(CASE WHEN T1.CATEGORY = ''customer'' THEN ''30%''
		WHEN T1.CATEGORY = ''geography'' THEN ''25%''
		WHEN T1.CATEGORY = ''products and services'' THEN ''25%''
		WHEN T1.CATEGORY = ''transactions'' THEN ''10%''
		WHEN T1.CATEGORY = ''delivery channels'' THEN ''10%''
		WHEN T1.CATEGORY = ''Governance & Management Oversight'' THEN ''10%''
		WHEN T1.CATEGORY = ''Customer Due Diligence & Risk Management'' THEN ''25%''   
		WHEN T1.CATEGORY = ''Transactions Monitoring'' THEN ''10%''
		WHEN T1.CATEGORY = ''Internal Quality Assurance and Compliance Testing'' THEN ''10%''
		WHEN T1.CATEGORY = ''Name/Sanctions Screening'' THEN ''10%''
		WHEN T1.CATEGORY = ''Training'' THEN ''15%''
		WHEN T1.CATEGORY = ''Foreign Correspondent Banking Relationships'' THEN ''5%''
		WHEN T1.CATEGORY = ''Internal Audit'' THEN ''10%''
		WHEN T1.CATEGORY = ''Reporting Requirements'' THEN ''5%''
		ELSE ''N.A.'' END) AS WEIGHT, 
		T1.SCORE, T1.SCORE AS RESULT  FROM
		(SELECT
		FINALRISKRATING AS SCORE, CATEGORY
		FROM COMAML_CM.TB_RARISKRATINGS A 
		LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO 
		WHERE A.CATEGORY = A.SUBCATEGORY
		AND A.ASSESSMENTUNIT = ''RetailLiabilities''
		AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T1';

vcSQL3 :=
         'SELECT ROW_NUMBER() OVER (ORDER BY
		CASE 
		WHEN T1.CATEGORY = ''customer'' THEN 1
		WHEN T1.CATEGORY = ''geography'' THEN 2
		WHEN T1.CATEGORY = ''products and services'' THEN 3
		WHEN T1.CATEGORY = ''transactions'' THEN 4
		WHEN T1.CATEGORY = ''delivery channels'' THEN 5
		WHEN T1.CATEGORY = ''Governance & Management Oversight'' THEN 6
		WHEN T1.CATEGORY = ''Customer Due Diligence & Risk Management'' THEN 7   
		WHEN T1.CATEGORY = ''Transactions Monitoring'' THEN 8
		WHEN T1.CATEGORY = ''Internal Quality Assurance and Compliance Testing'' THEN 9
		WHEN T1.CATEGORY = ''Name/Sanctions Screening'' THEN 10
		WHEN T1.CATEGORY = ''Training'' THEN 11
		WHEN T1.CATEGORY = ''Foreign Correspondent Banking Relationships'' THEN 12
		WHEN T1.CATEGORY = ''Internal Audit'' THEN 13
		WHEN T1.CATEGORY = ''Reporting Requirements'' THEN 14
		ELSE 15 END) AS SRNO,
		T1.CATEGORY, 
		(CASE WHEN T1.CATEGORY = ''customer'' THEN ''30%''
		WHEN T1.CATEGORY = ''geography'' THEN ''25%''
		WHEN T1.CATEGORY = ''products and services'' THEN ''25%''
		WHEN T1.CATEGORY = ''transactions'' THEN ''10%''
		WHEN T1.CATEGORY = ''delivery channels'' THEN ''10%''
		WHEN T1.CATEGORY = ''Governance & Management Oversight'' THEN ''10%''
		WHEN T1.CATEGORY = ''Customer Due Diligence & Risk Management'' THEN ''25%''   
		WHEN T1.CATEGORY = ''Transactions Monitoring'' THEN ''10%''
		WHEN T1.CATEGORY = ''Internal Quality Assurance and Compliance Testing'' THEN ''10%''
		WHEN T1.CATEGORY = ''Name/Sanctions Screening'' THEN ''10%''
		WHEN T1.CATEGORY = ''Training'' THEN ''15%''
		WHEN T1.CATEGORY = ''Foreign Correspondent Banking Relationships'' THEN ''5%''
		WHEN T1.CATEGORY = ''Internal Audit'' THEN ''10%''
		WHEN T1.CATEGORY = ''Reporting Requirements'' THEN ''5%''
		ELSE ''N.A.'' END) AS WEIGHT, 
		T1.SCORE, T1.SCORE AS RESULT  FROM
		(SELECT
		FINALRISKRATING AS SCORE, CATEGORY
		FROM COMAML_CM.TB_RARISKRATINGS A 
		LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO 
		WHERE A.CATEGORY = A.SUBCATEGORY
		AND A.ASSESSMENTUNIT = ''RetailAssets''
		AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T1';

vcSQL4 :=
         'SELECT ROW_NUMBER() OVER (ORDER BY
		CASE 
		WHEN T1.CATEGORY = ''customer'' THEN 1
		WHEN T1.CATEGORY = ''geography'' THEN 2
		WHEN T1.CATEGORY = ''products and services'' THEN 3
		WHEN T1.CATEGORY = ''transactions'' THEN 4
		WHEN T1.CATEGORY = ''delivery channels'' THEN 5
		WHEN T1.CATEGORY = ''Governance & Management Oversight'' THEN 6
		WHEN T1.CATEGORY = ''Customer Due Diligence & Risk Management'' THEN 7   
		WHEN T1.CATEGORY = ''Transactions Monitoring'' THEN 8
		WHEN T1.CATEGORY = ''Internal Quality Assurance and Compliance Testing'' THEN 9
		WHEN T1.CATEGORY = ''Name/Sanctions Screening'' THEN 10
		WHEN T1.CATEGORY = ''Training'' THEN 11
		WHEN T1.CATEGORY = ''Foreign Correspondent Banking Relationships'' THEN 12
		WHEN T1.CATEGORY = ''Internal Audit'' THEN 13
		WHEN T1.CATEGORY = ''Reporting Requirements'' THEN 14
		ELSE 15 END) AS SRNO,
		T1.CATEGORY, 
		(CASE WHEN T1.CATEGORY = ''customer'' THEN ''30%''
		WHEN T1.CATEGORY = ''geography'' THEN ''25%''
		WHEN T1.CATEGORY = ''products and services'' THEN ''25%''
		WHEN T1.CATEGORY = ''transactions'' THEN ''10%''
		WHEN T1.CATEGORY = ''delivery channels'' THEN ''10%''
		WHEN T1.CATEGORY = ''Governance & Management Oversight'' THEN ''10%''
		WHEN T1.CATEGORY = ''Customer Due Diligence & Risk Management'' THEN ''25%''   
		WHEN T1.CATEGORY = ''Transactions Monitoring'' THEN ''10%''
		WHEN T1.CATEGORY = ''Internal Quality Assurance and Compliance Testing'' THEN ''10%''
		WHEN T1.CATEGORY = ''Name/Sanctions Screening'' THEN ''10%''
		WHEN T1.CATEGORY = ''Training'' THEN ''15%''
		WHEN T1.CATEGORY = ''Foreign Correspondent Banking Relationships'' THEN ''5%''
		WHEN T1.CATEGORY = ''Internal Audit'' THEN ''10%''
		WHEN T1.CATEGORY = ''Reporting Requirements'' THEN ''5%''
		ELSE ''N.A.'' END) AS WEIGHT, 
		T1.SCORE, T1.SCORE AS RESULT  FROM
		(SELECT
		FINALRISKRATING AS SCORE, CATEGORY
		FROM COMAML_CM.TB_RARISKRATINGS A 
		LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO 
		WHERE A.CATEGORY = A.SUBCATEGORY
		AND A.ASSESSMENTUNIT = ''WholesaleBanking''
		AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T1';

vcSQL5 :=
        'SELECT T1.SRNO, T1.CATEGORY, T1.Weight,
T1.T_Score, T1.T_Result, 
T2.RL_Score , T2.RL_Result, 
T3.RA_Score , T3.RA_Result,
T4.WB_Score , T4.WB_Result
FROM 
(SELECT 
CASE WHEN A.CATEGORY = ''customer'' THEN 1 ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''customer'' THEN ''30%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Score,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''customer''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''Treasury''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T1
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''customer'' THEN 1 ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''customer'' THEN ''30%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''customer''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailLiabilities''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T2
ON (T1.CATEGORY = T2.CATEGORY)
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''customer'' THEN 1 ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''customer'' THEN ''30%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''customer''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailAssets''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T3
ON (T2.CATEGORY = T3.CATEGORY)
FULL OUTER JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''customer'' THEN 1 ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''customer'' THEN ''30%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Score,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''customer''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''WholesaleBanking''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T4
ON (T3.CATEGORY = T4.CATEGORY)

UNION ALL

SELECT T1.SRNO, t1.category, T1.Weight,
T1.T_Score, T1.T_Result, 
T2.RL_Score , T2.RL_Result, 
T3.RA_Score , T3.RA_Result,
T4.WB_Score , T4.WB_Result
FROM 
(SELECT 
CASE WHEN A.CATEGORY = ''geography'' THEN 2 ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''geography'' THEN ''25%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Score,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''geography''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''Treasury''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T1
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''geography'' THEN 2 ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''geography'' THEN ''25%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''geography''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailLiabilities''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T2
ON (T1.CATEGORY = T2.CATEGORY)
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''geography'' THEN 2 ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''geography'' THEN ''25%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''geography''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailAssets''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T3
ON (T2.CATEGORY = T3.CATEGORY)
FULL OUTER JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''geography'' THEN 2 ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''geography'' THEN ''25%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Score,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''geography''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''WholesaleBanking''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T4
ON (T3.CATEGORY = T4.CATEGORY)
UNION ALL

SELECT T1.SRNO, t1.category, T1.Weight,
T1.T_Score, T1.T_Result, 
T2.RL_Score , T2.RL_Result, 
T3.RA_Score , T3.RA_Result,
T4.WB_Score , T4.WB_Result
FROM 
(SELECT 
CASE WHEN A.CATEGORY = ''products and services'' THEN 3 ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''products and services'' THEN ''25%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Score,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''products and services''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''Treasury''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T1
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''products and services'' THEN 3 ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''products and services'' THEN ''25%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''products and services''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailLiabilities''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T2
ON (T1.CATEGORY = T2.CATEGORY)
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''products and services'' THEN 3 ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''products and services'' THEN ''25%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''products and services''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailAssets''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T3
ON (T2.CATEGORY = T3.CATEGORY)
FULL OUTER JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''products and services'' THEN 3 ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''products and services'' THEN ''25%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Score,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''products and services''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''WholesaleBanking''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T4
ON (T3.CATEGORY = T4.CATEGORY)
UNION ALL

SELECT T1.SRNO, t1.category, T1.Weight,
T1.T_Score, T1.T_Result, 
T2.RL_Score , T2.RL_Result, 
T3.RA_Score , T3.RA_Result,
T4.WB_Score , T4.WB_Result
FROM 
(SELECT 
CASE WHEN A.CATEGORY = ''transactions'' THEN 4 ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''transactions'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Score,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''transactions''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''Treasury''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T1
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''transactions'' THEN 4 ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''transactions'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''transactions''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailLiabilities''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T2
ON (T1.CATEGORY = T2.CATEGORY)
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''transactions'' THEN 4 ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''transactions'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''transactions''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailAssets''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T3
ON (T2.CATEGORY = T3.CATEGORY)
FULL OUTER JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''transactions'' THEN 4 ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''transactions'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Score,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''transactions''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''WholesaleBanking''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T4
ON (T3.CATEGORY = T4.CATEGORY)
UNION ALL

SELECT T1.SRNO, t1.category, T1.Weight,
T1.T_Score, T1.T_Result, 
T2.RL_Score , T2.RL_Result, 
T3.RA_Score , T3.RA_Result,
T4.WB_Score , T4.WB_Result
FROM 
(SELECT 
CASE WHEN A.CATEGORY = ''delivery channels'' THEN 5  ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''delivery channels'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Score,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''delivery channels''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''Treasury''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T1
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''delivery channels'' THEN 5  ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''delivery channels'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''delivery channels''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailLiabilities''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T2
ON (T1.CATEGORY = T2.CATEGORY)
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''delivery channels'' THEN 5  ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''delivery channels'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''delivery channels''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailAssets''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T3
ON (T2.CATEGORY = T3.CATEGORY)
FULL OUTER JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''delivery channels'' THEN 5  ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''delivery channels'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Score,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''delivery channels''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''WholesaleBanking''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T4
ON (T3.CATEGORY = T4.CATEGORY)
UNION ALL

SELECT T1.SRNO, t1.category, T1.Weight,
T1.T_Score, T1.T_Result, 
T2.RL_Score , T2.RL_Result, 
T3.RA_Score , T3.RA_Result,
T4.WB_Score , T4.WB_Result
FROM 
(SELECT 
CASE WHEN A.CATEGORY = ''Governance & Management Oversight'' THEN 6  ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Governance & Management Oversight'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Score,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Governance & Management Oversight''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''Treasury''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T1
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Governance & Management Oversight'' THEN 6   ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Governance & Management Oversight'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Governance & Management Oversight''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailLiabilities''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T2
ON (T1.CATEGORY = T2.CATEGORY)
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Governance & Management Oversight'' THEN 6   ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Governance & Management Oversight'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Governance & Management Oversight''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailAssets''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T3
ON (T2.CATEGORY = T3.CATEGORY)
FULL OUTER JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Governance \& Management Oversight'' THEN 6   ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Governance \& Management Oversight'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Score,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Governance & Management Oversight''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''WholesaleBanking''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T4
ON (T3.CATEGORY = T4.CATEGORY)
UNION ALL

SELECT T1.SRNO, t1.category, T1.Weight,
T1.T_Score, T1.T_Result, 
T2.RL_Score , T2.RL_Result, 
T3.RA_Score , T3.RA_Result,
T4.WB_Score , T4.WB_Result
FROM 
(SELECT 
CASE WHEN A.CATEGORY = ''Customer Due Diligence & Risk Management'' THEN 7   ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Customer Due Diligence & Risk Management'' THEN ''25%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Score,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Customer Due Diligence & Risk Management''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''Treasury''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T1
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Customer Due Diligence & Risk Management'' THEN 7    ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Customer Due Diligence & Risk Management'' THEN ''25%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Customer Due Diligence & Risk Management''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailLiabilities''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T2
ON (T1.CATEGORY = T2.CATEGORY)
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Customer Due Diligence & Risk Management'' THEN 7    ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Customer Due Diligence & Risk Management'' THEN ''25%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Customer Due Diligence & Risk Management''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailAssets''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T3
ON (T2.CATEGORY = T3.CATEGORY)
FULL OUTER JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Customer Due Diligence & Risk Management'' THEN 7    ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Customer Due Diligence & Risk Management'' THEN ''25%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Score,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Customer Due Diligence & Risk Management''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''WholesaleBanking''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T4
ON (T3.CATEGORY = T4.CATEGORY)
UNION ALL

SELECT T1.SRNO, t1.category, T1.Weight,
T1.T_Score, T1.T_Result, 
T2.RL_Score , T2.RL_Result, 
T3.RA_Score , T3.RA_Result,
T4.WB_Score , T4.WB_Result
FROM 
(SELECT 
CASE WHEN A.CATEGORY = ''Transactions Monitoring'' THEN 8    ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Transactions Monitoring'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Score,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Transactions Monitoring''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''Treasury''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T1
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Transactions Monitoring'' THEN 8     ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Transactions Monitoring'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Transactions Monitoring''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailLiabilities''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T2
ON (T1.CATEGORY = T2.CATEGORY)
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Transactions Monitoring'' THEN 8     ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Transactions Monitoring'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Transactions Monitoring''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailAssets''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T3
ON (T2.CATEGORY = T3.CATEGORY)
FULL OUTER JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Transactions Monitoring'' THEN 8     ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Transactions Monitoring'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Score,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Transactions Monitoring''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''WholesaleBanking''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T4
ON (T3.CATEGORY = T4.CATEGORY)
UNION ALL

SELECT T1.SRNO, t1.category, T1.Weight,
T1.T_Score, T1.T_Result, 
T2.RL_Score , T2.RL_Result, 
T3.RA_Score , T3.RA_Result,
T4.WB_Score , T4.WB_Result
FROM 
(SELECT 
CASE WHEN A.CATEGORY = ''Internal Quality Assurance and Compliance Testing'' THEN 9 ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Internal Quality Assurance and Compliance Testing'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Score,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Internal Quality Assurance and Compliance Testing''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''Treasury''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T1
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Internal Quality Assurance and Compliance Testing'' THEN 9  ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Internal Quality Assurance and Compliance Testing'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Internal Quality Assurance and Compliance Testing''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailLiabilities''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T2
ON (T1.CATEGORY = T2.CATEGORY)
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Internal Quality Assurance and Compliance Testing'' THEN 9  ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Internal Quality Assurance and Compliance Testing'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Internal Quality Assurance and Compliance Testing''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailAssets''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T3
ON (T2.CATEGORY = T3.CATEGORY)
FULL OUTER JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Internal Quality Assurance and Compliance Testing'' THEN 9  ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Internal Quality Assurance and Compliance Testing'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Score,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Internal Quality Assurance and Compliance Testing''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''WholesaleBanking''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T4
ON (T3.CATEGORY = T4.CATEGORY)
UNION ALL

SELECT T1.SRNO, t1.category, T1.Weight,
T1.T_Score, T1.T_Result, 
T2.RL_Score , T2.RL_Result, 
T3.RA_Score , T3.RA_Result,
T4.WB_Score , T4.WB_Result
FROM 
(SELECT 
CASE WHEN A.CATEGORY = ''Name/Sanctions Screening'' THEN 10  ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Name/Sanctions Screening'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Score,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Name/Sanctions Screening''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''Treasury''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T1
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Name/Sanctions Screening'' THEN 10   ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Name/Sanctions Screening'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Name/Sanctions Screening''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailLiabilities''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T2
ON (T1.CATEGORY = T2.CATEGORY)
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Name/Sanctions Screening'' THEN 10   ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Name/Sanctions Screening'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Name/Sanctions Screening''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailAssets''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T3
ON (T2.CATEGORY = T3.CATEGORY)
FULL OUTER JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Name/Sanctions Screening'' THEN 10   ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Name/Sanctions Screening'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Score,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Name/Sanctions Screening''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''WholesaleBanking''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T4
ON (T3.CATEGORY = T4.CATEGORY)
UNION ALL

SELECT T1.SRNO, t1.category, T1.Weight,
T1.T_Score, T1.T_Result, 
T2.RL_Score , T2.RL_Result, 
T3.RA_Score , T3.RA_Result,
T4.WB_Score , T4.WB_Result
FROM 
(SELECT 
CASE WHEN A.CATEGORY = ''Training'' THEN 11  ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Training'' THEN ''15%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Score,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Training''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''Treasury''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T1
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Training'' THEN 11   ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Training'' THEN ''15%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Training''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailLiabilities''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T2
ON (T1.CATEGORY = T2.CATEGORY)
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Training'' THEN 11   ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Training'' THEN ''15%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Training''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailAssets''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T3
ON (T2.CATEGORY = T3.CATEGORY)
FULL OUTER JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Training'' THEN 11   ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Training'' THEN ''15%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Score,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Training''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''WholesaleBanking''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T4
ON (T3.CATEGORY = T4.CATEGORY)
UNION ALL

SELECT T1.SRNO, t1.category, T1.Weight,
T1.T_Score, T1.T_Result, 
T2.RL_Score , T2.RL_Result, 
T3.RA_Score , T3.RA_Result,
T4.WB_Score , T4.WB_Result
FROM 
(SELECT 
CASE WHEN A.CATEGORY = ''Foreign Correspondent Banking Relationships'' THEN 12  ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Foreign Correspondent Banking Relationships'' THEN ''5%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Score,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Foreign Correspondent Banking Relationships''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''Treasury''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T1
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Foreign Correspondent Banking Relationships'' THEN 12   ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Foreign Correspondent Banking Relationships'' THEN ''5%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Foreign Correspondent Banking Relationships''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailLiabilities''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T2
ON (T1.CATEGORY = T2.CATEGORY)
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Foreign Correspondent Banking Relationships'' THEN 12   ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Foreign Correspondent Banking Relationships'' THEN ''5%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Foreign Correspondent Banking Relationships''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailAssets''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T3
ON (T2.CATEGORY = T3.CATEGORY)
FULL OUTER JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Foreign Correspondent Banking Relationships'' THEN 12   ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Foreign Correspondent Banking Relationships'' THEN ''5%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Score,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Foreign Correspondent Banking Relationships''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''WholesaleBanking''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T4
ON (T3.CATEGORY = T4.CATEGORY)
UNION ALL

SELECT T1.SRNO, t1.category, T1.Weight,
T1.T_Score, T1.T_Result, 
T2.RL_Score , T2.RL_Result, 
T3.RA_Score , T3.RA_Result,
T4.WB_Score , T4.WB_Result
FROM 
(SELECT 
CASE WHEN A.CATEGORY = ''Internal Audit'' THEN 13  ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Internal Audit'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Score,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Internal Audit''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''Treasury''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T1
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Internal Audit'' THEN 13   ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Internal Audit'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Internal Audit''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailLiabilities''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T2
ON (T1.CATEGORY = T2.CATEGORY)
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Internal Audit'' THEN 13   ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Internal Audit'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Internal Audit''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailAssets''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T3
ON (T2.CATEGORY = T3.CATEGORY)
FULL OUTER JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Internal Audit'' THEN 13   ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Internal Audit'' THEN ''10%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Score,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Internal Audit''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''WholesaleBanking''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T4
ON (T3.CATEGORY = T4.CATEGORY)
UNION ALL

SELECT T1.SRNO, t1.category, T1.Weight,
T1.T_Score, T1.T_Result, 
T2.RL_Score , T2.RL_Result, 
T3.RA_Score , T3.RA_Result,
T4.WB_Score , T4.WB_Result
FROM 
(SELECT 
CASE WHEN A.CATEGORY = ''Reporting Requirements'' THEN 14  ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Reporting Requirements'' THEN ''5%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Score,
CASE WHEN A.ASSESSMENTUNIT = ''Treasury'' THEN A.FINALRISKRATING ELSE ''0'' END T_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Reporting Requirements''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''Treasury''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T1
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Reporting Requirements'' THEN 14   ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Reporting Requirements'' THEN ''5%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailLiabilities'' THEN A.FINALRISKRATING ELSE ''0'' END RL_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Reporting Requirements''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailLiabilities''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T2
ON (T1.CATEGORY = T2.CATEGORY)
full outer JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Reporting Requirements'' THEN 14   ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Reporting Requirements'' THEN ''5%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Score,
CASE WHEN A.ASSESSMENTUNIT = ''RetailAssets'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END RA_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Reporting Requirements''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''RetailAssets''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T3
ON (T2.CATEGORY = T3.CATEGORY)
FULL OUTER JOIN
(SELECT 
CASE WHEN A.CATEGORY = ''Reporting Requirements'' THEN 14   ELSE 15 END SRNO,
CATEGORY, 
CASE WHEN A.CATEGORY = ''Reporting Requirements'' THEN ''5%'' ELSE ''10%'' END Weight,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Score,
CASE WHEN A.ASSESSMENTUNIT = ''WholesaleBanking'' THEN NVL(A.FINALRISKRATING, 0) ELSE ''0'' END WB_Result
FROM TB_RARISKRATINGS A
LEFT OUTER JOIN TB_RAFORMGENERALDETAILS B ON A.CMREFNO = B.CMREFNO
WHERE A.CATEGORY = ''Reporting Requirements''
AND A.CATEGORY = A.SUBCATEGORY
AND b.assessmentunit = ''WholesaleBanking''
AND B.ASSESSMENTPERIOD = '''||i_vcAssessmentPeriod||''') T4
ON (T3.CATEGORY = T4.CATEGORY)';

vcSQL6 :=
         'SELECT CREFNUM, VERSION_SEQNO, QUESTIONID, NVL(QUESTIONVALUE, '' '') QUESTIONVALUE, NVL(REMARKS, '' '') REMARKS,
          NVL(ASSESSMENTCTRLSCORE, '' '') IMPACTRISKRATING, '' '' LIKELIHOODRISKRATING
          FROM TB_CMCONTROLPARAMETERDETAILS
          WHERE CREFNUM ='''||i_vcAssessmentPeriod||''' ';

vcSQL7 :=
         'SELECT ''Customer'' AS ASSESSMENT_UNIT, CUSTOMERSYSTEMGENRISK AS System_Generated_Risk_Rating, CUSTOMERPROVISRISK AS 	Provisional_Risk_Rating,
          CUSTOMERFINALRISK AS Final_Risk_Rating FROM TB_CMGENRLFINALRISKDETAILS WHERE CREFNUM='''||i_vcAssessmentPeriod||'''
          UNION ALL
          SELECT ''Geography'' AS ASSESSMENT_UNIT, GEOGSYSTEMGENRISK AS System_Generated_Risk_Rating, GEOGPROVISRISK AS Provisional_Risk_Rating,
          GEOGFINALRISK AS Final_Risk_Rating FROM TB_CMGENRLFINALRISKDETAILS WHERE CREFNUM='''||i_vcAssessmentPeriod||'''
          UNION ALL
          SELECT ''Products and Services'' AS ASSESSMENT_UNIT, PRODUCTSSYSTEMGENRISK AS System_Generated_Risk_Rating, PRODUCTSPROVISRISK AS Provisional_Risk_Rating,
          PRODUCTSFINALRISK AS Final_Risk_Rating FROM TB_CMGENRLFINALRISKDETAILS WHERE CREFNUM='''||i_vcAssessmentPeriod||'''
          UNION ALL
          SELECT ''Transactions'' AS ASSESSMENT_UNIT, TRANSACTIONSSYSTEMGENRISK AS System_Generated_Risk_Rating, TRANSACTIONSPROVISRISK AS 	Provisional_Risk_Rating,
          TRANSACTIONSFINALRISK AS Final_Risk_Rating FROM TB_CMGENRLFINALRISKDETAILS WHERE CREFNUM='''||i_vcAssessmentPeriod||'''
          UNION ALL
          SELECT ''Delivery Channels'' AS ASSESSMENT_UNIT, DELIVERYSYSTEMGENRISK AS System_Generated_Risk_Rating, DELIVERYPROVISRISK AS Provisional_Risk_Rating,
          DELIVERYFINALRISK AS Final_Risk_Rating FROM TB_CMGENRLFINALRISKDETAILS WHERE CREFNUM='''||i_vcAssessmentPeriod||'''
          UNION ALL
          SELECT ''Control Parameters'' AS ASSESSMENT_UNIT, CONTROLSYSTEMGENRISK AS System_Generated_Risk_Rating, CONTROLPROVISRISK AS 	Provisional_Risk_Rating,
          CONTROLFINALRISK AS Final_Risk_Rating FROM TB_CMGENRLFINALRISKDETAILS WHERE CREFNUM='''||i_vcAssessmentPeriod||'''
          UNION ALL
          SELECT ''Residual Risk Rating'' AS ASSESSMENT_UNIT, RESIDUALSYSTEMGENRISK AS System_Generated_Risk_Rating, RESIDUALPROVRISK AS Provisional_Risk_Rating,
          RESIDUALFINALRISK AS Final_Risk_Rating FROM TB_CMGENRLFINALRISKDETAILS WHERE CREFNUM='''||i_vcAssessmentPeriod||'''
          UNION ALL
          SELECT ''Total Inherent Assessment Units Risk Rating'' AS ASSESSMENT_UNIT, TOTINHSYSGENRISK AS System_Generated_Risk_Rating, TOTINHPROVISRISK AS Provisional_Risk_Rating,
          TOTINHFINALRISK AS Final_Risk_Rating FROM TB_CMGENRLFINALRISKDETAILS WHERE CREFNUM='''||i_vcAssessmentPeriod||'''
          UNION ALL
          SELECT ''Total Control Parameters Risk Rating'' AS ASSESSMENT_UNIT, TOTCONTPARSYSGENRISK AS System_Generated_Risk_Rating, TOTCONTPARPROVISRISK AS Provisional_Risk_Rating,
          TOTCONTPARFINALRISK AS Final_Risk_Rating FROM TB_CMGENRLFINALRISKDETAILS WHERE CREFNUM='''||i_vcAssessmentPeriod||''' ';

   Open io_cuResultSet0 FOR vcSQL0 ;
	 Open io_cuResultSet1 FOR vcSQL1 ;
	 Open io_cuResultSet2 FOR vcSQL2 ;
	 Open io_cuResultSet3 FOR vcSQL3 ;
	 Open io_cuResultSet4 FOR vcSQL4 ;
	 Open io_cuResultSet5 FOR vcSQL5 ;
	 Open io_cuResultSet6 FOR vcSQL6 ;
   Open io_cuResultSet7 FOR vcSQL7 ;

END STP_GETCMREPORTDATASUMMARY;